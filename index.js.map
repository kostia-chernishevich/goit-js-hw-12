{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n \nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = import.meta.env.VITE_PIXABAY_KEY;\n\nexport async function getImagesByQuery(query, page=1) {\n    if (query.trim().length === 0) {\n  throw new Error(\"Empty query\");\n  }\n  \n  try {\n    const resp = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page:page,\n      }, timeout: 10000\n    });\n    return {\n      hits: resp.data.hits,\n      totalHits: resp.data.totalHits\n    };\n  }catch(err){\n  const status = err?.response?.status;\n  \n\n  let message;\n  if (status === 403) {\n    message = \"Invalid API key\";\n  } else if (status === 429) {\n    message = \"Rate limit exceeded, try again later\";\n  } else {\n    message = \"Network or server error\";\n  }\n\n  throw new Error(message);\n}\n\n}   ","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox = null;\n\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\n\n\nfunction ensureLightbox() {\n    \n    if (!lightbox) {\n        lightbox = new SimpleLightbox(\".gallery a\", {\n            captionsData: \"alt\",\n            captionDelay: 250,\n            nav: true,\n            loop: true,\n            showCounter: true,\n           \n        });\n    } else {\n\n        lightbox.refresh();\n    }\n}\n\n\n\n\nexport function createGallery(images, append=true) {\n    const markup = images\n        .map(\n            (img) => `\n      <li class=\"card\">\n        <a href=\"${img.largeImageURL}\" rel=\"noopener noreferrer\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags || \"image\"}\" loading=\"lazy\">\n        </a>\n        <ul class=\"stats\">\n          <li><span>Likes</span><span>${img.likes}</span></li>\n          <li><span>Views</span><span>${img.views}</span></li>\n          <li><span>Comments</span><span>${img.comments}</span></li>\n          <li><span>Downloads</span><span>${img.downloads}</span></li>\n        </ul>\n      </li>`\n        )\n        .join(\"\");\n    if (append) {\n     gallery.insertAdjacentHTML(\"beforeend\", markup);\n    } else {\n   gallery.innerHTML = markup;\n}\n   \n\n\n    ensureLightbox();\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    if (loader) loader.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n    if (loader) loader.classList.add(\"hidden\");\n}\nexport function hideLoadMoreButton() {\n      const loadMoreBtn = document.querySelector('.hidden-btn');\n    if (loadMoreBtn) loadMoreBtn.style.display= 'none';\n  \n}\nexport function showLoadMoreButton() {\n      const loadMoreBtn = document.querySelector('.hidden-btn');\n      if (loadMoreBtn) loadMoreBtn.style.display= 'block';\n    \n }","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from \"./js/render-functions.js\";\n\nconst form = document.querySelector(\".form\");\nconst input = document.querySelector('[name=\"search-text\"]');\nconst loadMoreBtn = document.querySelector('.hidden-btn');\n\nlet currentQuery = \"\";\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n\n  const query = input.value.trim();\n  if (!query) return; \n\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n\n  currentQuery = query;\n  page = 1;\n\n  try {\n    const resp = await getImagesByQuery(currentQuery, page);\n\n    const hits = resp.hits;\n    totalHits = resp.totalHits;\n\n\n    if (hits.length === 0) {\n      iziToast.info({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n      return;\n    }\n\n    createGallery(hits, false);\n\n    if (totalHits > page * 15) {\n      showLoadMoreButton(); \n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    iziToast.error({ message: err.message || \"Network or server error\" });\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  page += 1;\n  showLoader();\n  hideLoadMoreButton(); \n  try {\n    const resp  = await getImagesByQuery(currentQuery, page);\n    const hits = resp.hits;\n    totalHits = resp.totalHits;\n    \n    createGallery(hits, true);\n\n    if (totalHits > page * 15) {\n      showLoadMoreButton();\n      \n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n   \n    const cardHeight = document.querySelector(\".card\").getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: \"smooth\" });\n\n    if (window.lightbox) {\n      window.lightbox.refresh();\n    }\n  } catch (err) {\n    iziToast.error({ message: err.message });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","resp","axios","err","status","_a","message","lightbox","gallery","loader","ensureLightbox","SimpleLightbox","createGallery","images","append","markup","img","clearGallery","showLoader","hideLoader","hideLoadMoreButton","loadMoreBtn","showLoadMoreButton","form","input","currentQuery","totalHits","event","hits","iziToast","cardHeight"],"mappings":"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"}